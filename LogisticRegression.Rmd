---
title: "LogisticRegression"
author: "Julian Nieto"
date: "April 8, 2019"
output: html_document
---

```{r}
trainData = read.csv("train.csv")
testData = read.csv("test.csv")
```


```{r}
library(corrplot)

corr.d <- cor( proj_data_cleaned )
corr.d[ lower.tri( corr.d, diag = TRUE ) ] <- NA
corrplot( corr.d, type = "upper", diag = FALSE )

newProjData = proj_data_cleaned[, -seq(8, 117)]

mylogit <- glm(`Radiant Win` ~ ., data = newProjData, family = "binomial")
summary(mylogit)


ols <- glm(`Radiant Win` ~ ., data = proj_data_cleaned)

```



```{r}
# load library
library(neuralnet)

# fit neural network
herosOnly = cbind(trainData$RadiantWin, trainData[, seq(8, 117)])
colnames(herosOnly)[1] = "RadiantWin"
nn=neuralnet(`RadiantWin`~ ., data = herosOnly, hidden= c(100, 200) ,act.fct = "logistic",
                linear.output = FALSE)

plot(nn)
herosOnlyTest = cbind(testData$RadiantWin, testData[, seq(8, 117)])
nn.results <- compute(nn, testData[, seq(8, 117)])
results <- data.frame(actual = testData$RadiantWin, prediction = nn.results$net.result)

roundedresults<-sapply(results,round,digits=0)
roundedresultsdf=data.frame(roundedresults)
attach(roundedresultsdf)
table(actual,prediction)


#newdata = 
#sum(predict(nn,newdata) > .5)
#sum(newdata$RadiantWin)

```

Neural Network, logistic regresion, and random forest
